service
=======

.. py:module:: service

.. autoapi-nested-parse::

   Generic index service using dependency injection.

   This orchestrator manages vector indexing and search operations
   through abstract protocols, enabling swappable implementations.



Classes
-------

.. autoapisummary::

   service.IndexService


Module Contents
---------------

.. py:class:: IndexService(vector_store, embedding_dim, embed_fn, *, collection_name, metric_type = 'IP', index_type = 'HNSW')

   Generic vector index service with dependency injection.

   This service orchestrates indexing and search operations through
   a VectorStoreService interface, remaining agnostic to the specific
   vector database implementation (Milvus, Pinecone, etc).


   .. py:attribute:: vector_store


   .. py:attribute:: embedding_dim


   .. py:attribute:: embed_fn


   .. py:attribute:: collection_name


   .. py:attribute:: metric_type
      :value: 'IP'



   .. py:attribute:: index_type
      :value: 'HNSW'



   .. py:method:: ensure_collection(schema, index_params = None)

      Ensure collection exists with schema and index.

      :param schema: Collection schema (implementation-specific).
      :param index_params: Optional index parameters.



   .. py:method:: upsert(data)

      Upsert data into the collection.

      :param data: Sequence of dictionaries with entity data.



   .. py:method:: search(query_embedding, *, top_k = 5, output_fields = None, search_params = None, expr = None)

      Search collection by embedding vector.

      :param query_embedding: Query vector.
      :param top_k: Number of results to return.
      :param output_fields: Fields to return in results.
      :param search_params: Search-specific parameters.
      :param expr: Filter expression.

      :returns: List of result dictionaries with scores and fields.



   .. py:method:: query(expr, *, output_fields = None, limit = 10)

      Execute scalar query on collection.

      :param expr: Filter expression.
      :param output_fields: Fields to return.
      :param limit: Max results.

      :returns: List of matching entities.



   .. py:method:: drop_collection()

      Drop the collection.



