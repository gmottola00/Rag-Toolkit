src.rag_toolkit.core.ingestion.base
===================================

.. py:module:: src.rag_toolkit.core.ingestion.base

.. autoapi-nested-parse::

   Abstract interfaces for document ingestion.

   This module defines the protocol/interface layer for ingestion operations.
   All concrete implementations should live in src/infra/parsers/.



Attributes
----------

.. autoapisummary::

   src.rag_toolkit.core.ingestion.base.PageDict


Classes
-------

.. autoapisummary::

   src.rag_toolkit.core.ingestion.base.DocumentParser
   src.rag_toolkit.core.ingestion.base.OCREngine
   src.rag_toolkit.core.ingestion.base.LanguageDetector
   src.rag_toolkit.core.ingestion.base.HeadingDetector
   src.rag_toolkit.core.ingestion.base.TableDetector


Module Contents
---------------

.. py:data:: PageDict

   A page is a dictionary with text, blocks, and metadata.

.. py:class:: DocumentParser

   Bases: :py:obj:`Protocol`


   Abstract interface for parsing documents into structured pages.

   Implementations can be PDF parsers, DOCX parsers, or any other
   document format parser.


   .. py:method:: parse(path)

      Parse a document file into a list of structured pages.

      :param path: Path to the document file

      :returns:     - page_num: int
                    - text: str (aggregated text)
                    - blocks: List[Dict] (structured blocks)
                    - metadata: Dict (optional)
      :rtype: List of page dictionaries, each containing



.. py:class:: OCREngine

   Bases: :py:obj:`Protocol`


   Abstract interface for OCR operations.

   Implementations can use Tesseract, cloud OCR services, or other engines.


   .. py:method:: needs_ocr(input_path, text_threshold = 200)

      Check if a document needs OCR based on existing text content.

      :param input_path: Path to the document (usually PDF)
      :param text_threshold: Minimum text length to consider document as text-based

      :returns: True if OCR is needed, False otherwise



   .. py:method:: apply_ocr(input_path, output_path)

      Apply OCR to a document and save the result.

      :param input_path: Path to the input document
      :param output_path: Path where to save the OCR-ed document



.. py:class:: LanguageDetector

   Bases: :py:obj:`Protocol`


   Abstract interface for language detection.

   Implementations can use fastText, langdetect, or cloud services.


   .. py:method:: detect(text)

      Detect the language of a text string.

      :param text: Input text to analyze

      :returns: ISO language code (e.g., 'en', 'it', 'fr')



.. py:class:: HeadingDetector

   Bases: :py:obj:`Protocol`


   Abstract interface for heading detection in documents.

   Can use heuristics, ML models, or rule-based systems.


   .. py:method:: detect_headings(blocks)

      Classify blocks as headings or regular text.

      :param blocks: List of text blocks with formatting info

      :returns: Same blocks with added 'is_heading' boolean field



.. py:class:: TableDetector

   Bases: :py:obj:`Protocol`


   Abstract interface for table detection in documents.


   .. py:method:: detect_tables(page_data)

      Detect and extract tables from a page.

      :param page_data: Page dictionary with layout information

      :returns: List of table dictionaries with extracted data



