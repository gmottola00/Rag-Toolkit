src.rag_toolkit.infra.storage.supabase
======================================

.. py:module:: src.rag_toolkit.infra.storage.supabase

.. autoapi-nested-parse::

   Supabase storage implementation.



Classes
-------

.. autoapisummary::

   src.rag_toolkit.infra.storage.supabase.SupabaseStorageClient


Functions
---------

.. autoapisummary::

   src.rag_toolkit.infra.storage.supabase.get_storage_client


Module Contents
---------------

.. py:class:: SupabaseStorageClient(bucket_name, url, api_key, public = False)

   Supabase storage adapter for file management.


   .. py:attribute:: bucket_name


   .. py:attribute:: public
      :value: False



   .. py:method:: ensure_bucket()

      Create the bucket if it does not exist.



   .. py:method:: build_path(tender_id, lot_id, filename)

      Build a hierarchical storage path.

      Structure: tenders/{tender_id}/lots/{lot_id}/documents/{filename}

      :param tender_id: Tender identifier
      :param lot_id: Optional lot identifier
      :param filename: Name of the file

      :returns: Storage path string



   .. py:method:: upload_bytes(path, data, content_type = None)

      Upload raw bytes to the configured bucket.

      :param path: Storage path
      :param data: File data as bytes
      :param content_type: Optional MIME type (e.g., 'application/pdf')

      :raises StorageException: If upload fails



   .. py:method:: download_bytes(path)

      Download raw bytes from the configured bucket.

      :param path: Storage path

      :returns: File data as bytes

      :raises StorageException: If download fails



   .. py:method:: delete(path)

      Delete a file from storage.

      :param path: Storage path

      :raises StorageException: If deletion fails



.. py:function:: get_storage_client()

   Factory function for creating a configured storage client.

   :returns: Configured SupabaseStorageClient instance

   :raises RuntimeError: If STORAGE_BUCKET is not configured

   .. admonition:: Example

      >>> storage = get_storage_client()
      >>> storage.upload_bytes("path/to/file.pdf", pdf_bytes, "application/pdf")


