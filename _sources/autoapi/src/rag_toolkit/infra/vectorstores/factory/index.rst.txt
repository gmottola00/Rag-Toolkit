src.rag_toolkit.infra.vectorstores.factory
==========================================

.. py:module:: src.rag_toolkit.infra.vectorstores.factory

.. autoapi-nested-parse::

   Factory for creating vector store services and index services.

   This module provides production-ready factory functions for instantiating
   vector stores with sensible defaults while allowing configuration overrides.



Functions
---------

.. autoapisummary::

   src.rag_toolkit.infra.vectorstores.factory.create_milvus_service
   src.rag_toolkit.infra.vectorstores.factory.create_index_service
   src.rag_toolkit.infra.vectorstores.factory.create_qdrant_service
   src.rag_toolkit.infra.vectorstores.factory.create_chroma_service


Module Contents
---------------

.. py:function:: create_milvus_service(*, uri = None, user = None, password = None, db_name = None, secure = False, timeout = None, alias = 'default')

   Create a configured MilvusService instance.

   :param uri: Milvus connection URI (defaults to MILVUS_URI env var or localhost:19530).
   :param user: Username for authentication (defaults to MILVUS_USER env var).
   :param password: Password for authentication (defaults to MILVUS_PASSWORD env var).
   :param db_name: Database name (defaults to MILVUS_DB env var or "default").
   :param secure: Use TLS encryption.
   :param timeout: Connection timeout in seconds.
   :param alias: Connection alias for management.

   :returns: Configured MilvusService instance.

   .. admonition:: Example

      ```python
      from rag_toolkit.infra.vectorstores.factory import create_milvus_service
      
      # Use environment variables
      service = create_milvus_service()
      
      # Override specific settings
      service = create_milvus_service(
          uri="http://localhost:19530",
          db_name="production"
      )
      ```


.. py:function:: create_index_service(embedding_dim, embed_fn, *, collection_name = None, metric_type = None, index_type = None, vector_store = None)

   Create a configured IndexService with Milvus backend.

   :param embedding_dim: Dimensionality of embeddings.
   :param embed_fn: Function to generate embeddings from text.
   :param collection_name: Collection name (defaults to MILVUS_COLLECTION env var or "tender_chunks").
   :param metric_type: Distance metric (defaults to MILVUS_METRIC env var or "IP").
   :param index_type: Index type (defaults to MILVUS_INDEX_TYPE env var or "HNSW").
   :param vector_store: Optional pre-configured vector store (creates new if None).

   :returns: Configured IndexService instance.

   .. admonition:: Example

      ```python
      from rag_toolkit.infra.vectorstores.factory import create_index_service
      from rag_toolkit.core.embedding import EmbeddingClient
      
      # Create embedding client
      embed_client = EmbeddingClient(...)
      
      # Create index service
      index_service = create_index_service(
          embedding_dim=1536,
          embed_fn=lambda texts: embed_client.embed_batch(texts),
          collection_name="my_collection"
      )
      ```


.. py:function:: create_qdrant_service(*, url = None, api_key = None, timeout = None, https = False, grpc_port = None, prefer_grpc = False)

   Create a configured QdrantService instance.

   :param url: Qdrant server URL (defaults to QDRANT_URL env var or http://localhost:6333).
   :param api_key: API key for authentication (defaults to QDRANT_API_KEY env var).
   :param timeout: Request timeout in seconds.
   :param https: Use HTTPS for connection.
   :param grpc_port: gRPC port for high-performance operations.
   :param prefer_grpc: Prefer gRPC over HTTP when available.

   :returns: Configured QdrantService instance.

   .. admonition:: Example

      ```python
      from rag_toolkit.infra.vectorstores.factory import create_qdrant_service
      
      # Use environment variables
      service = create_qdrant_service()
      
      # Override specific settings
      service = create_qdrant_service(
          url="http://localhost:6333",
          prefer_grpc=True
      )
      
      # Cloud instance
      service = create_qdrant_service(
          url="https://xyz-example.eu-central.aws.cloud.qdrant.io:6333",
          api_key="your-api-key",
          https=True
      )
      ```


.. py:function:: create_chroma_service(*, path = None, host = None, port = None, ssl = False, tenant = 'default_tenant', database = 'default_database')

   Create a configured ChromaService instance.

   :param path: Path for persistent storage (defaults to CHROMA_PATH env var).
                If None and host is None, uses in-memory mode.
   :param host: ChromaDB server host (defaults to CHROMA_HOST env var).
   :param port: ChromaDB server port (defaults to CHROMA_PORT env var or 8000).
   :param ssl: Use SSL for remote connections.
   :param tenant: Tenant name for multi-tenancy.
   :param database: Database name within tenant.

   :returns: Configured ChromaService instance.

   .. admonition:: Example

      ```python
      from rag_toolkit.infra.vectorstores.factory import create_chroma_service
      
      # In-memory mode (default)
      service = create_chroma_service()
      
      # Persistent mode
      service = create_chroma_service(path="./chroma_data")
      
      # Remote server
      service = create_chroma_service(
          host="localhost",
          port=8000
      )
      
      # Cloud instance with SSL
      service = create_chroma_service(
          host="chroma.example.com",
          port=443,
          ssl=True
      )
      ```


